{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import Swal from\"sweetalert2\";import\"./NuevaMateria.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const NuevaMateria=()=>{const[nombre,setNombre]=useState(\"\");const[carrera,setCarrera]=useState(\"\");const[carreras,setCarreras]=useState([]);const[anio,setAnio]=useState(\"\");const[opcionesAnio,setOpcionesAnio]=useState([]);// Mapeo para mostrar \"1º\", \"2º\", etc.\nconst anioMap={\"1\":\"1º\",\"2\":\"2º\",\"3\":\"3º\",\"4\":\"4º\",\"5\":\"5º\",\"6\":\"6º\"};useEffect(()=>{const fetchCarreras=async()=>{try{const token=localStorage.getItem(\"token\");const response=await fetch(\"http://localhost:5000/carreras\",{method:\"GET\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${token}`}});if(response.ok){let data=await response.json();data.sort((a,b)=>{return a.subcategoria.localeCompare(b.subcategoria);});setCarreras(data);}else{console.error(\"Error al obtener las carreras\");}}catch(error){console.error(\"Error en la solicitud:\",error);}};fetchCarreras();},[]);const handleCarreraChange=e=>{const selectedCarrera=e.target.value;setCarrera(selectedCarrera);setAnio(\"\");// Resetear el año al cambiar la carrera\n// Convertir a minúsculas para evitar problemas de comparación\nif(selectedCarrera.toLowerCase().includes(\"tec.\")){setOpcionesAnio([\"1\",\"2\",\"3\"]);}else if(selectedCarrera.toLowerCase().includes(\"prof.\")){setOpcionesAnio([\"1\",\"2\",\"3\",\"4\"]);}else{setOpcionesAnio([]);// Si no se encuentra coincidencia, no mostrar opciones\n}};const handleNombreChange=e=>{const value=e.target.value;if(/^[^0-9]*$/.test(value)){setNombre(value);}};const handleGuardar=async()=>{if(!nombre||!carrera||!anio){Swal.fire({icon:\"error\",title:\"Error\",text:\"Todos los campos son obligatorios.\"});return;}try{const token=localStorage.getItem(\"token\");const response=await fetch(\"http://localhost:5000/materias\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${token}`},body:JSON.stringify({carrera,nombre_materia:nombre,anio})});if(response.ok){Swal.fire({icon:\"success\",title:\"Éxito\",text:\"Materia guardada correctamente.\"});// Solo se reinicia el input de nombre\nsetNombre(\"\");}else{Swal.fire({icon:\"error\",title:\"Error\",text:\"Error al guardar la materia.\"});}}catch(error){console.error(\"Error al guardar la materia:\",error);Swal.fire({icon:\"error\",title:\"Error\",text:\"Error al conectar con el servidor.\"});}};return/*#__PURE__*/_jsxs(\"div\",{className:\"nueva-materia-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Nueva Materia\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label-seleccionar-carrera\",children:\"Seleccionar carrera\"}),/*#__PURE__*/_jsxs(\"select\",{value:carrera,onChange:handleCarreraChange,className:\"select-field\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Seleccione una carrera\"}),carreras.map(c=>/*#__PURE__*/_jsx(\"option\",{value:c.subcategoria,children:c.subcategoria},c.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group-horizontal\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label-anio\",children:\"A\\xF1o\"}),/*#__PURE__*/_jsxs(\"select\",{value:anio,onChange:e=>setAnio(e.target.value),className:\"select-reducido\",disabled:!carrera// Deshabilita si carrera no está seleccionada\n,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Seleccione un a\\xF1o\"}),opcionesAnio.length>0?opcionesAnio.map((opcion,index)=>/*#__PURE__*/_jsxs(\"option\",{value:opcion,children:[anioMap[opcion],\" \"]},index)):/*#__PURE__*/_jsx(\"option\",{disabled:true,children:\"No hay opciones disponibles\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label-nombre-materia\",children:\"Nombre de la materia\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"input-reducido\",value:nombre,placeholder:\"Ingrese el nombre\",onChange:handleNombreChange})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"form-buttons\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn-primary\",onClick:handleGuardar,children:\"Guardar\"})})]});};export default NuevaMateria;","map":{"version":3,"names":["React","useState","useEffect","Swal","jsx","_jsx","jsxs","_jsxs","NuevaMateria","nombre","setNombre","carrera","setCarrera","carreras","setCarreras","anio","setAnio","opcionesAnio","setOpcionesAnio","anioMap","fetchCarreras","token","localStorage","getItem","response","fetch","method","headers","Authorization","ok","data","json","sort","a","b","subcategoria","localeCompare","console","error","handleCarreraChange","e","selectedCarrera","target","value","toLowerCase","includes","handleNombreChange","test","handleGuardar","fire","icon","title","text","body","JSON","stringify","nombre_materia","className","children","onChange","map","c","id","disabled","length","opcion","index","type","placeholder","onClick"],"sources":["C:/Users/Fede/Desktop/Proyecto/registro-login/src/components/forms/NuevaMateria.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport Swal from \"sweetalert2\";\r\nimport \"./NuevaMateria.css\";\r\n\r\nconst NuevaMateria = () => {\r\n  const [nombre, setNombre] = useState(\"\");\r\n  const [carrera, setCarrera] = useState(\"\"); \r\n  const [carreras, setCarreras] = useState([]);\r\n  const [anio, setAnio] = useState(\"\"); \r\n  const [opcionesAnio, setOpcionesAnio] = useState([]); \r\n\r\n    // Mapeo para mostrar \"1º\", \"2º\", etc.\r\n    const anioMap = {\r\n      \"1\": \"1º\",\r\n      \"2\": \"2º\",\r\n      \"3\": \"3º\",\r\n      \"4\": \"4º\",\r\n      \"5\": \"5º\",\r\n      \"6\": \"6º\",\r\n    };\r\n\r\n  useEffect(() => {\r\n    const fetchCarreras = async () => {\r\n      try {\r\n        const token = localStorage.getItem(\"token\");\r\n        const response = await fetch(\"http://localhost:5000/carreras\", {\r\n          method: \"GET\",\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            Authorization: `Bearer ${token}`,\r\n          },\r\n        });\r\n        if (response.ok) {\r\n          let data = await response.json();\r\n\r\n          data.sort((a, b) => {\r\n            return a.subcategoria.localeCompare(b.subcategoria); \r\n          });\r\n\r\n          setCarreras(data);\r\n        } else {\r\n          console.error(\"Error al obtener las carreras\");\r\n        }\r\n      } catch (error) {\r\n        console.error(\"Error en la solicitud:\", error);\r\n      }\r\n    };\r\n\r\n    fetchCarreras();\r\n  }, []);\r\n\r\n  const handleCarreraChange = (e) => {\r\n    const selectedCarrera = e.target.value;\r\n    setCarrera(selectedCarrera);\r\n    setAnio(\"\"); // Resetear el año al cambiar la carrera\r\n  \r\n    // Convertir a minúsculas para evitar problemas de comparación\r\n    if (selectedCarrera.toLowerCase().includes(\"tec.\")) {\r\n      setOpcionesAnio([\"1\", \"2\", \"3\"]);\r\n    } else if (selectedCarrera.toLowerCase().includes(\"prof.\")) {\r\n      setOpcionesAnio([\"1\", \"2\", \"3\", \"4\"]);\r\n    } else {\r\n      setOpcionesAnio([]); // Si no se encuentra coincidencia, no mostrar opciones\r\n    }\r\n  };\r\n  \r\n\r\n  const handleNombreChange = (e) => {\r\n    const value = e.target.value;\r\n    if (/^[^0-9]*$/.test(value)) {\r\n      setNombre(value);\r\n    }\r\n  };\r\n\r\n  const handleGuardar = async () => {\r\n    if (!nombre || !carrera || !anio) {\r\n      Swal.fire({\r\n        icon: \"error\",\r\n        title: \"Error\",\r\n        text: \"Todos los campos son obligatorios.\",\r\n      });\r\n      return;\r\n    }\r\n  \r\n    try {\r\n      const token = localStorage.getItem(\"token\");\r\n      const response = await fetch(\"http://localhost:5000/materias\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n        body: JSON.stringify({ carrera, nombre_materia: nombre, anio }),\r\n      });\r\n  \r\n      if (response.ok) {\r\n        Swal.fire({\r\n          icon: \"success\",\r\n          title: \"Éxito\",\r\n          text: \"Materia guardada correctamente.\",\r\n        });\r\n        // Solo se reinicia el input de nombre\r\n        setNombre(\"\");\r\n      } else {\r\n        Swal.fire({\r\n          icon: \"error\",\r\n          title: \"Error\",\r\n          text: \"Error al guardar la materia.\",\r\n        });\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error al guardar la materia:\", error);\r\n      Swal.fire({\r\n        icon: \"error\",\r\n        title: \"Error\",\r\n        text: \"Error al conectar con el servidor.\",\r\n      });\r\n    }\r\n  }; \r\n\r\n  return (\r\n    <div className=\"nueva-materia-container\">\r\n      <h2>Nueva Materia</h2>\r\n\r\n      <div className=\"form-group\">\r\n        <label className=\"label-seleccionar-carrera\">Seleccionar carrera</label>\r\n        <select\r\n          value={carrera}\r\n          onChange={handleCarreraChange}\r\n          className=\"select-field\"\r\n        >\r\n          <option value=\"\">Seleccione una carrera</option>\r\n          {carreras.map((c) => (\r\n            <option key={c.id} value={c.subcategoria}>\r\n              {c.subcategoria}\r\n            </option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n\r\n      <div className=\"form-group-horizontal\">\r\n        <div className=\"form-group\">\r\n          <label className=\"label-anio\">Año</label>\r\n          <select\r\n            value={anio}\r\n            onChange={(e) => setAnio(e.target.value)}\r\n            className=\"select-reducido\"\r\n            disabled={!carrera}  // Deshabilita si carrera no está seleccionada\r\n          >\r\n            <option value=\"\">Seleccione un año</option>\r\n            {opcionesAnio.length > 0 ? (\r\n              opcionesAnio.map((opcion, index) => (\r\n                <option key={index} value={opcion}>\r\n                  {anioMap[opcion]} {/* Aquí aplicamos el mapeo */}\r\n                </option>\r\n              ))\r\n            ) : (\r\n              <option disabled>No hay opciones disponibles</option>\r\n            )}\r\n          </select>\r\n        </div>\r\n\r\n        <div className=\"form-group\">\r\n          <label className=\"label-nombre-materia\">Nombre de la materia</label>\r\n          <input\r\n            type=\"text\"\r\n            className=\"input-reducido\"\r\n            value={nombre}\r\n            placeholder=\"Ingrese el nombre\"\r\n            onChange={handleNombreChange}\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"form-buttons\">\r\n        <button className=\"btn-primary\" onClick={handleGuardar}>\r\n          Guardar\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default NuevaMateria;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}